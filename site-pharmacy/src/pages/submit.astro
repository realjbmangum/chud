---
import BaseLayout from '../layouts/BaseLayout.astro';

// Form submission will be handled by Cloudflare Pages Function
// POST to /api/submit
---

<BaseLayout
  title="Add Your Independent Pharmacy | Indie Pharmacy"
  description="List your independent pharmacy for free. Reach customers who value local ownership and personal service."
>
  <section class="py-12 bg-stone-50">
    <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="bg-white rounded-xl shadow-sm border border-stone-200 p-8">
        <div class="text-center mb-8">
          <span class="inline-block bg-primary-100 text-primary-700 text-sm font-semibold px-3 py-1 rounded-full mb-3">Always free</span>
          <h1 class="text-3xl font-bold text-stone-900 mb-4">Add your pharmacy</h1>
          <p class="text-lg text-stone-600">
            Get listed in the largest independent pharmacy directory. No cost, no catch.
          </p>
        </div>

        <form action="/api/submit" method="POST" class="space-y-6" id="submitForm">
          <!-- Business Information -->
          <div>
            <h2 class="text-xl font-semibold text-stone-900 mb-4">Business Information</h2>

            <div class="space-y-4">
              <div>
                <label for="business_name" class="block text-sm font-medium text-stone-700 mb-1">
                  Pharmacy Name <span class="text-red-500">*</span>
                </label>
                <input
                  type="text"
                  id="business_name"
                  name="business_name"
                  required
                  class="w-full px-4 py-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                  placeholder="Smith's Family Pharmacy"
                />
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="contact_name" class="block text-sm font-medium text-stone-700 mb-1">
                    Your Name <span class="text-red-500">*</span>
                  </label>
                  <input
                    type="text"
                    id="contact_name"
                    name="contact_name"
                    required
                    class="w-full px-4 py-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                    placeholder="John Smith"
                  />
                </div>

                <div>
                  <label for="contact_email" class="block text-sm font-medium text-stone-700 mb-1">
                    Email Address <span class="text-red-500">*</span>
                  </label>
                  <input
                    type="email"
                    id="contact_email"
                    name="contact_email"
                    required
                    class="w-full px-4 py-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                    placeholder="john@smithspharmacy.com"
                  />
                </div>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="phone" class="block text-sm font-medium text-stone-700 mb-1">
                    Phone Number
                  </label>
                  <input
                    type="tel"
                    id="phone"
                    name="phone"
                    class="w-full px-4 py-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                    placeholder="(555) 123-4567"
                  />
                </div>

                <div>
                  <label for="website" class="block text-sm font-medium text-stone-700 mb-1">
                    Website
                  </label>
                  <input
                    type="url"
                    id="website"
                    name="website"
                    class="w-full px-4 py-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                    placeholder="https://smithspharmacy.com"
                  />
                </div>
              </div>
            </div>
          </div>

          <!-- Location -->
          <div>
            <h2 class="text-xl font-semibold text-stone-900 mb-4">Location</h2>

            <div class="space-y-4">
              <div>
                <label for="street_address" class="block text-sm font-medium text-stone-700 mb-1">
                  Street Address
                </label>
                <input
                  type="text"
                  id="street_address"
                  name="street_address"
                  class="w-full px-4 py-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                  placeholder="123 Main Street"
                />
              </div>

              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                  <label for="city" class="block text-sm font-medium text-stone-700 mb-1">
                    City <span class="text-red-500">*</span>
                  </label>
                  <input
                    type="text"
                    id="city"
                    name="city"
                    required
                    class="w-full px-4 py-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                    placeholder="Denver"
                  />
                </div>

                <div>
                  <label for="state" class="block text-sm font-medium text-stone-700 mb-1">
                    State <span class="text-red-500">*</span>
                  </label>
                  <select
                    id="state"
                    name="state"
                    required
                    class="w-full px-4 py-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                  >
                    <option value="">Select State</option>
                    <option value="AL">Alabama</option>
                    <option value="AK">Alaska</option>
                    <option value="AZ">Arizona</option>
                    <option value="AR">Arkansas</option>
                    <option value="CA">California</option>
                    <option value="CO">Colorado</option>
                    <option value="CT">Connecticut</option>
                    <option value="DE">Delaware</option>
                    <option value="FL">Florida</option>
                    <option value="GA">Georgia</option>
                  </select>
                </div>

                <div>
                  <label for="postal_code" class="block text-sm font-medium text-stone-700 mb-1">
                    ZIP Code
                  </label>
                  <input
                    type="text"
                    id="postal_code"
                    name="postal_code"
                    class="w-full px-4 py-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                    placeholder="80202"
                  />
                </div>
              </div>
            </div>
          </div>

          <!-- Ownership -->
          <div>
            <h2 class="text-xl font-semibold text-stone-900 mb-4">Ownership & Independence</h2>

            <div class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-stone-700 mb-2">
                  Is your pharmacy independently owned? <span class="text-red-500">*</span>
                </label>
                <div class="space-y-2">
                  <label class="flex items-center">
                    <input type="radio" name="ownership_type" value="independent" required class="mr-2 text-primary-600" />
                    <span class="text-stone-700">Yes, 100% independently owned (not part of any chain)</span>
                  </label>
                  <label class="flex items-center">
                    <input type="radio" name="ownership_type" value="small_chain" class="mr-2 text-primary-600" />
                    <span class="text-stone-700">Part of a small local chain (2-5 locations)</span>
                  </label>
                  <label class="flex items-center">
                    <input type="radio" name="ownership_type" value="franchise" class="mr-2 text-primary-600" />
                    <span class="text-stone-700">Franchise (e.g., Medicine Shoppe, Good Neighbor)</span>
                  </label>
                </div>
              </div>

              <div id="chainNameField" class="hidden">
                <label for="chain_name" class="block text-sm font-medium text-stone-700 mb-1">
                  Chain/Franchise Name
                </label>
                <input
                  type="text"
                  id="chain_name"
                  name="chain_name"
                  class="w-full px-4 py-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                  placeholder="Medicine Shoppe"
                />
              </div>
            </div>
          </div>

          <!-- Services -->
          <div>
            <h2 class="text-xl font-semibold text-stone-900 mb-4">Services Offered</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
              <label class="flex items-center">
                <input type="checkbox" name="services[]" value="compounding" class="mr-2 text-primary-600" />
                <span class="text-stone-700">Compounding</span>
              </label>
              <label class="flex items-center">
                <input type="checkbox" name="services[]" value="24-hour" class="mr-2 text-primary-600" />
                <span class="text-stone-700">24-Hour Service</span>
              </label>
              <label class="flex items-center">
                <input type="checkbox" name="services[]" value="delivery" class="mr-2 text-primary-600" />
                <span class="text-stone-700">Home Delivery</span>
              </label>
              <label class="flex items-center">
                <input type="checkbox" name="services[]" value="immunizations" class="mr-2 text-primary-600" />
                <span class="text-stone-700">Immunizations</span>
              </label>
              <label class="flex items-center">
                <input type="checkbox" name="services[]" value="dme" class="mr-2 text-primary-600" />
                <span class="text-stone-700">DME (Durable Medical Equipment)</span>
              </label>
              <label class="flex items-center">
                <input type="checkbox" name="services[]" value="pet_medications" class="mr-2 text-primary-600" />
                <span class="text-stone-700">Pet Medications</span>
              </label>
            </div>
          </div>

          <!-- Description -->
          <div>
            <label for="description" class="block text-sm font-medium text-stone-700 mb-1">
              Tell us about your pharmacy (optional)
            </label>
            <textarea
              id="description"
              name="description"
              rows="4"
              class="w-full px-4 py-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
              placeholder="Share what makes your pharmacy special, your history, specialties, or anything else customers should know."
            ></textarea>
          </div>

          <!-- Submit -->
          <div class="pt-4">
            <button
              type="submit"
              class="w-full bg-primary-600 hover:bg-primary-700 text-white font-semibold py-3 px-6 rounded-lg transition"
            >
              Submit for Review
            </button>
            <p class="text-sm text-stone-500 text-center mt-3">
              We'll review your submission and add your pharmacy within 3 business days.
            </p>
          </div>
        </form>

        <!-- IndiePro upsell -->
        <div class="mt-8 pt-8 border-t border-stone-200 text-center">
          <p class="text-stone-600 mb-2">Want tools to grow your business?</p>
          <a href="/pro" class="inline-flex items-center text-accent-600 hover:text-accent-700 font-semibold">
            Check out IndiePro &mdash; CRM, reviews, and more
            <svg class="w-5 h-5 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
            </svg>
          </a>
        </div>
      </div>
    </div>
  </section>

  <script>
    const ownershipRadios = document.querySelectorAll('input[name="ownership_type"]');
    const chainNameField = document.getElementById('chainNameField');

    ownershipRadios.forEach((radio) => {
      radio.addEventListener('change', (e) => {
        const value = (e.target as HTMLInputElement).value;
        if (value === 'small_chain' || value === 'franchise') {
          chainNameField?.classList.remove('hidden');
        } else {
          chainNameField?.classList.add('hidden');
        }
      });
    });
  </script>
</BaseLayout>
